<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tutorial | LiteSVM</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/litesvm/public/favicon.ico" type="image/x-icon">
    <meta name="description" content="">
    
    <link rel="preload" href="/litesvm/assets/css/0.styles.fca07d9d.css" as="style"><link rel="preload" href="/litesvm/assets/js/app.75d0f61c.js" as="script"><link rel="preload" href="/litesvm/assets/js/2.81c74c22.js" as="script"><link rel="preload" href="/litesvm/assets/js/1.8dcf7571.js" as="script"><link rel="preload" href="/litesvm/assets/js/42.d8eb3ae9.js" as="script"><link rel="prefetch" href="/litesvm/assets/js/10.c48ba95a.js"><link rel="prefetch" href="/litesvm/assets/js/11.0802895b.js"><link rel="prefetch" href="/litesvm/assets/js/12.d2e0073b.js"><link rel="prefetch" href="/litesvm/assets/js/13.92ad8c1a.js"><link rel="prefetch" href="/litesvm/assets/js/14.d8ebd787.js"><link rel="prefetch" href="/litesvm/assets/js/15.10b8d1ca.js"><link rel="prefetch" href="/litesvm/assets/js/16.47e1d84d.js"><link rel="prefetch" href="/litesvm/assets/js/17.e24ddb35.js"><link rel="prefetch" href="/litesvm/assets/js/18.71ba5781.js"><link rel="prefetch" href="/litesvm/assets/js/19.7375c917.js"><link rel="prefetch" href="/litesvm/assets/js/20.c235ed00.js"><link rel="prefetch" href="/litesvm/assets/js/21.b0fe5a4b.js"><link rel="prefetch" href="/litesvm/assets/js/22.292db116.js"><link rel="prefetch" href="/litesvm/assets/js/23.c82ed3cf.js"><link rel="prefetch" href="/litesvm/assets/js/24.2956900f.js"><link rel="prefetch" href="/litesvm/assets/js/25.f5f322d7.js"><link rel="prefetch" href="/litesvm/assets/js/26.5d5e88fb.js"><link rel="prefetch" href="/litesvm/assets/js/27.120d97e8.js"><link rel="prefetch" href="/litesvm/assets/js/28.453dfcb6.js"><link rel="prefetch" href="/litesvm/assets/js/29.b195bc0b.js"><link rel="prefetch" href="/litesvm/assets/js/3.732d1f6f.js"><link rel="prefetch" href="/litesvm/assets/js/30.56487505.js"><link rel="prefetch" href="/litesvm/assets/js/31.98ecfe0d.js"><link rel="prefetch" href="/litesvm/assets/js/32.e69d2a23.js"><link rel="prefetch" href="/litesvm/assets/js/33.ad9569da.js"><link rel="prefetch" href="/litesvm/assets/js/34.5a917b93.js"><link rel="prefetch" href="/litesvm/assets/js/35.1ef31c20.js"><link rel="prefetch" href="/litesvm/assets/js/36.8780572f.js"><link rel="prefetch" href="/litesvm/assets/js/37.f0702326.js"><link rel="prefetch" href="/litesvm/assets/js/38.ad82a45d.js"><link rel="prefetch" href="/litesvm/assets/js/39.8a0124e5.js"><link rel="prefetch" href="/litesvm/assets/js/4.0471e9ae.js"><link rel="prefetch" href="/litesvm/assets/js/40.8d0d28ac.js"><link rel="prefetch" href="/litesvm/assets/js/41.c0137015.js"><link rel="prefetch" href="/litesvm/assets/js/5.a9be735e.js"><link rel="prefetch" href="/litesvm/assets/js/6.8707daba.js"><link rel="prefetch" href="/litesvm/assets/js/7.6a688e3c.js"><link rel="prefetch" href="/litesvm/assets/js/vendors~docsearch.934ed2fb.js">
    <link rel="stylesheet" href="/litesvm/assets/css/0.styles.fca07d9d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/litesvm/" class="home-link router-link-active"><!----> <span class="site-name">LiteSVM</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/litesvm/tutorial/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Tutorial
</a></div><div class="nav-item"><a href="/litesvm/api/" class="nav-link">
  API Reference
</a></div> <a href="https://github.com/LiteSVM/litesvm" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/litesvm/tutorial/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Tutorial
</a></div><div class="nav-item"><a href="/litesvm/api/" class="nav-link">
  API Reference
</a></div> <a href="https://github.com/LiteSVM/litesvm" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tutorial</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/litesvm/tutorial/#deploying-programs" class="sidebar-link">Deploying programs</a></li><li><a href="/litesvm/tutorial/#time-travel" class="sidebar-link">Time travel</a></li><li><a href="/litesvm/tutorial/#writing-arbitrary-accounts" class="sidebar-link">Writing arbitrary accounts</a></li><li><a href="/litesvm/tutorial/#other-features" class="sidebar-link">Other features</a></li><li><a href="/litesvm/tutorial/#when-should-i-use-solana-test-validator" class="sidebar-link">When should I use solana-test-validator?</a></li><li><a href="/litesvm/tutorial/#supported-platforms" class="sidebar-link">Supported platforms</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tutorial"><a href="#tutorial" class="header-anchor">#</a> Tutorial</h1> <h2 id="deploying-programs"><a href="#deploying-programs" class="header-anchor">#</a> Deploying programs</h2> <p>Most of the time we want to do more than just mess around with token transfers -
we want to test our own programs.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you want to pull a Solana program from mainnet or devnet, use the <code>solana program dump</code> command from the Solana CLI.</p></div> <p>To add a compiled program to our tests we can use the <code>addProgramFromFile</code> method.</p> <p>Here's an example using a <a href="https://github.com/solana-labs/solana-program-library/tree/bd216c8103cd8eb9f5f32e742973e7afb52f3b81/examples/rust/logging" target="_blank" rel="noopener noreferrer">simple program<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
from the Solana Program Library that just does some logging:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> LiteSVM<span class="token punctuation">,</span> TransactionMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;litesvm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
	Keypair<span class="token punctuation">,</span>
	<span class="token constant">LAMPORTS_PER_SOL</span><span class="token punctuation">,</span>
	PublicKey<span class="token punctuation">,</span>
	Transaction<span class="token punctuation">,</span>
	TransactionInstruction<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;spl logging&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> programId <span class="token operator">=</span> PublicKey<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> svm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LiteSVM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	svm<span class="token punctuation">.</span><span class="token function">addProgramFromFile</span><span class="token punctuation">(</span>programId<span class="token punctuation">,</span> <span class="token string">&quot;program_bytes/spl_example_logging.so&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> payer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Keypair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	svm<span class="token punctuation">.</span><span class="token function">airdrop</span><span class="token punctuation">(</span>payer<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span> <span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token constant">LAMPORTS_PER_SOL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> blockhash <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">latestBlockhash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> ixs <span class="token operator">=</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">TransactionInstruction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			programId<span class="token punctuation">,</span>
			keys<span class="token operator">:</span> <span class="token punctuation">[</span>
				<span class="token punctuation">{</span> pubkey<span class="token operator">:</span> PublicKey<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> isSigner<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> isWritable<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> tx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Transaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	tx<span class="token punctuation">.</span>recentBlockhash <span class="token operator">=</span> blockhash<span class="token punctuation">;</span>
	tx<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">...</span>ixs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	tx<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>payer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// let's sim it first</span>
	<span class="token keyword">const</span> simRes <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">simulateTransaction</span><span class="token punctuation">(</span>tx<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> sendRes <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span>tx<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>sendRes <span class="token keyword">instanceof</span> <span class="token class-name">TransactionMetadata</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">expect</span><span class="token punctuation">(</span>simRes<span class="token punctuation">.</span><span class="token function">meta</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">logs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>sendRes<span class="token punctuation">.</span><span class="token function">logs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">expect</span><span class="token punctuation">(</span>sendRes<span class="token punctuation">.</span><span class="token function">logs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">&quot;Program log: static string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Unexpected tx failure&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="time-travel"><a href="#time-travel" class="header-anchor">#</a> Time travel</h2> <p>Many programs rely on the <code>Clock</code> sysvar: for example, a mint that doesn't become available until after
a certain time. With <code>litesvm</code> you can dynamically overwrite the <code>Clock</code> sysvar using <code>svm.setClock()</code>.
Here's an example using a program that panics if <code>clock.unix_timestamp</code> is greater than 100
(which is on January 1st 1970):</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
	Clock<span class="token punctuation">,</span>
	FailedTransactionMetadata<span class="token punctuation">,</span>
	LiteSVM<span class="token punctuation">,</span>
	TransactionMetadata<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;litesvm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
	Keypair<span class="token punctuation">,</span>
	<span class="token constant">LAMPORTS_PER_SOL</span><span class="token punctuation">,</span>
	PublicKey<span class="token punctuation">,</span>
	Transaction<span class="token punctuation">,</span>
	TransactionInstruction<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;clock&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> programId <span class="token operator">=</span> PublicKey<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> svm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LiteSVM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	svm<span class="token punctuation">.</span><span class="token function">addProgramFromFile</span><span class="token punctuation">(</span>programId<span class="token punctuation">,</span> <span class="token string">&quot;program_bytes/litesvm_clock_example.so&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> payer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Keypair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	svm<span class="token punctuation">.</span><span class="token function">airdrop</span><span class="token punctuation">(</span>payer<span class="token punctuation">.</span>publicKey<span class="token punctuation">,</span> <span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token constant">LAMPORTS_PER_SOL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> blockhash <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">latestBlockhash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> ixs <span class="token operator">=</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">TransactionInstruction</span><span class="token punctuation">(</span><span class="token punctuation">{</span> keys<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> programId<span class="token punctuation">,</span> data<span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> tx <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Transaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	tx<span class="token punctuation">.</span>recentBlockhash <span class="token operator">=</span> blockhash<span class="token punctuation">;</span>
	tx<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">...</span>ixs<span class="token punctuation">)</span><span class="token punctuation">;</span>
	tx<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>payer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// set the time to January 1st 2000</span>
	<span class="token keyword">const</span> initialClock <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">getClock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	initialClock<span class="token punctuation">.</span>unixTimestamp <span class="token operator">=</span> <span class="token number">1735689600n</span><span class="token punctuation">;</span>
	svm<span class="token punctuation">.</span><span class="token function">setClock</span><span class="token punctuation">(</span>initialClock<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// this will fail because the contract wants it to be January 1970</span>
	<span class="token keyword">const</span> failed <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span>tx<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>failed <span class="token keyword">instanceof</span> <span class="token class-name">FailedTransactionMetadata</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">expect</span><span class="token punctuation">(</span>failed<span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">&quot;ProgramFailedToComplete&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Expected transaction failure here&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// so let's turn back time</span>
	<span class="token keyword">const</span> newClock <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">getClock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	newClock<span class="token punctuation">.</span>unixTimestamp <span class="token operator">=</span> <span class="token number">50n</span><span class="token punctuation">;</span>
	svm<span class="token punctuation">.</span><span class="token function">setClock</span><span class="token punctuation">(</span>newClock<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> ixs2 <span class="token operator">=</span> <span class="token punctuation">[</span>
		<span class="token keyword">new</span> <span class="token class-name">TransactionInstruction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			keys<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			programId<span class="token punctuation">,</span>
			data<span class="token operator">:</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;foobar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// unused, just here to dedup the tx</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> tx2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Transaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	tx2<span class="token punctuation">.</span>recentBlockhash <span class="token operator">=</span> blockhash<span class="token punctuation">;</span>
	tx2<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">...</span>ixs2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	tx2<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>payer<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// now the transaction goes through</span>
	<span class="token keyword">const</span> success <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span>tx2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">expect</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeInstanceOf</span><span class="token punctuation">(</span>TransactionMetadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>See also: <code>svm.warpToSlot()</code>, which lets you jump to a future slot.</p> <h2 id="writing-arbitrary-accounts"><a href="#writing-arbitrary-accounts" class="header-anchor">#</a> Writing arbitrary accounts</h2> <p>LiteSVM lets you write any account data you want, regardless of
whether the account state would even be possible.</p> <p>Here's an example where we give an account a bunch of USDC,
even though we don't have the USDC mint keypair. This is
convenient for testing because it means we don't have to
work with fake USDC in our tests:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> LiteSVM <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;litesvm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PublicKey <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
	getAssociatedTokenAddressSync<span class="token punctuation">,</span>
	AccountLayout<span class="token punctuation">,</span>
	<span class="token constant">ACCOUNT_SIZE</span><span class="token punctuation">,</span>
	<span class="token constant">TOKEN_PROGRAM_ID</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/spl-token&quot;</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;infinite usdc mint&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> owner <span class="token operator">=</span> PublicKey<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> usdcMint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PublicKey</span><span class="token punctuation">(</span>
		<span class="token string">&quot;EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> ata <span class="token operator">=</span> <span class="token function">getAssociatedTokenAddressSync</span><span class="token punctuation">(</span>usdcMint<span class="token punctuation">,</span> owner<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> usdcToOwn <span class="token operator">=</span> <span class="token number">1_000_000_000_000n</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> tokenAccData <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token constant">ACCOUNT_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	AccountLayout<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>
		<span class="token punctuation">{</span>
			mint<span class="token operator">:</span> usdcMint<span class="token punctuation">,</span>
			owner<span class="token punctuation">,</span>
			amount<span class="token operator">:</span> usdcToOwn<span class="token punctuation">,</span>
			delegateOption<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			delegate<span class="token operator">:</span> PublicKey<span class="token punctuation">.</span>default<span class="token punctuation">,</span>
			delegatedAmount<span class="token operator">:</span> <span class="token number">0n</span><span class="token punctuation">,</span>
			state<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
			isNativeOption<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			isNative<span class="token operator">:</span> <span class="token number">0n</span><span class="token punctuation">,</span>
			closeAuthorityOption<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
			closeAuthority<span class="token operator">:</span> PublicKey<span class="token punctuation">.</span>default<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		tokenAccData<span class="token punctuation">,</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> svm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LiteSVM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	svm<span class="token punctuation">.</span><span class="token function">setAccount</span><span class="token punctuation">(</span>ata<span class="token punctuation">,</span> <span class="token punctuation">{</span>
		lamports<span class="token operator">:</span> <span class="token number">1_000_000_000</span><span class="token punctuation">,</span>
		data<span class="token operator">:</span> tokenAccData<span class="token punctuation">,</span>
		owner<span class="token operator">:</span> <span class="token constant">TOKEN_PROGRAM_ID</span><span class="token punctuation">,</span>
		executable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> rawAccount <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">getAccount</span><span class="token punctuation">(</span>ata<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">expect</span><span class="token punctuation">(</span>rawAccount<span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> rawAccountData <span class="token operator">=</span> rawAccount<span class="token operator">?.</span>data<span class="token punctuation">;</span>
	<span class="token keyword">const</span> decoded <span class="token operator">=</span> AccountLayout<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>rawAccountData<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">expect</span><span class="token punctuation">(</span>decoded<span class="token punctuation">.</span>amount<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>usdcToOwn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="copying-accounts-from-a-live-environment"><a href="#copying-accounts-from-a-live-environment" class="header-anchor">#</a> Copying Accounts from a live environment</h3> <p>If you want to copy accounts from mainnet or devnet, you can use the <code>solana account</code> command in the Solana CLI to save account data to a file.</p> <p>Or, if you want to pull live data every time you test, you can do this with a few lines of code. Here's a simple example that pulls account data from devnet
and passes it to LiteSVM:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> LiteSVM <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;litesvm&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> PublicKey<span class="token punctuation">,</span> Connection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@solana/web3.js&quot;</span><span class="token punctuation">;</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&quot;copy accounts from devnet&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> owner <span class="token operator">=</span> PublicKey<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> usdcMint <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PublicKey</span><span class="token punctuation">(</span>
		<span class="token string">&quot;EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Connection</span><span class="token punctuation">(</span><span class="token string">&quot;https://api.devnet.solana.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> accountInfo <span class="token operator">=</span> <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">getAccountInfo</span><span class="token punctuation">(</span>usdcMint<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// the rent epoch goes above 2**53 which breaks web3.js, so just set it to 0;</span>
	accountInfo<span class="token punctuation">.</span>rentEpoch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> svm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LiteSVM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	svm<span class="token punctuation">.</span><span class="token function">setAccount</span><span class="token punctuation">(</span>usdcMint<span class="token punctuation">,</span> accountInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">const</span> rawAccount <span class="token operator">=</span> svm<span class="token punctuation">.</span><span class="token function">getAccount</span><span class="token punctuation">(</span>usdcMint<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">expect</span><span class="token punctuation">(</span>rawAccount<span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="other-features"><a href="#other-features" class="header-anchor">#</a> Other features</h2> <p>Other things you can do with <code>litesvm</code> include:</p> <ul><li>Changing the max compute units and other compute budget behaviour using the <code>withComputeBudget</code> method.</li> <li>Disable transaction signature checking using <code>svm.withSigverify(false)</code>.</li> <li>Find previous transactions using the <code>getTransaction</code> method.</li></ul> <h2 id="when-should-i-use-solana-test-validator"><a href="#when-should-i-use-solana-test-validator" class="header-anchor">#</a> When should I use <code>solana-test-validator</code>?</h2> <p>While <code>litesvm</code> is faster and more convenient, it is also less like a real RPC node.
So <code>solana-test-validator</code> is still useful when you need to call RPC methods that LiteSVM
doesn't support, or when you want to test something that depends on real-life validator behaviour
rather than just testing your program and client code.</p> <p>In general though I would recommend using <code>litesvm</code> wherever possible, as it will make your life
much easier.</p> <h2 id="supported-platforms"><a href="#supported-platforms" class="header-anchor">#</a> Supported platforms</h2> <p><code>litesvm</code> is supported on Linux x64 and MacOS targets. If you find a platform that is not supported
but which can run the <code>litesvm</code> Rust crate, please open an issue.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/litesvm/" class="prev router-link-active">
        Introduction
      </a></span> <span class="next"><a href="/litesvm/api/">
        API Reference - v0.3.1
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/litesvm/assets/js/app.75d0f61c.js" defer></script><script src="/litesvm/assets/js/2.81c74c22.js" defer></script><script src="/litesvm/assets/js/1.8dcf7571.js" defer></script><script src="/litesvm/assets/js/42.d8eb3ae9.js" defer></script>
  </body>
</html>
